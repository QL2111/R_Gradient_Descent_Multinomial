```{r}
library(R6)

# Classe de régression logistique multinomiale
MultinomialLogistic <- R6::R6Class("MultinomialLogistic",
    public = list(
        coefficients = NULL,  # Coefficients du modèle
        model_fit = NULL,     # Modèle ajusté (objet glm ou similaire)
        
        # Méthode pour ajuster le modèle
        fit = function(X, y) {
            # Entraîner le modèle et stocker les coefficients
            self$model_fit <- glm(y ~ ., data = X, family = binomial)
            self$coefficients <- coef(self$model_fit)
        },
        
        # Méthode summary pour afficher un résumé des résultats du modèle
        summary = function() {
            if (is.null(self$model_fit)) {
                cat("Le modèle n'est pas encore ajusté. Veuillez exécuter la méthode fit().\n")
                return(NULL)
            }
            
            # Afficher les coefficients
            cat("Coefficients du modèle:\n")
            print(self$coefficients)
            
            # Calcul des statistiques d'ajustement
            aic <- AIC(self$model_fit)
            log_likelihood <- logLik(self$model_fit)
            deviance <- deviance(self$model_fit)
            
            # Afficher les statistiques d'ajustement
            cat("\nStatistiques d'ajustement:\n")
            cat("AIC:", aic, "\n")
            cat("Log-likelihood:", log_likelihood, "\n")
            cat("Deviance:", deviance, "\n")
            
            # Autres statistiques comme les erreurs standards et p-values
            cat("\nStatistiques des coefficients:\n")
            summary_stats <- summary(self$model_fit)$coefficients
            print(summary_stats)
        }
    )
)



```


```{r}
# Exemple d'utilisation
# Données d'exemple
data(iris)
iris$Species <- as.numeric(iris$Species == "setosa")  # Exemple binaire pour glm

# Préparation des données
X <- iris[, -5]
y <- iris$Species

# Instanciation et ajustement du modèle
model <- MultinomialLogistic$new()
model$fit(X, y)

# Affichage du résumé du modèle
model$summary()
```

